
trigger: none

pool: 
  vmimage: windows-latest


variables:
  BoxName: Box2

  
steps: 




- task: AzureResourceManagerTemplateDeployment@3
  inputs:
    deploymentScope: 'Subscription'
    azureResourceManagerConnection: 'radul (MCT)(1)(d8058b04-7da0-4499-b527-029c6d0158f7)'
    subscriptionId: 'd8058b04-7da0-4499-b527-029c6d0158f7'
    location: 'West Europe'
    templateLocation: 'Linked artifact'
    csmFile: 'vnetbox/rg.json'
    deploymentMode: 'Incremental'
    deploymentOutputs: rg-ArmOut
    
- task: PowerShell@2
  inputs:
    filePath: 'scripts/ReadOutputParameters.ps1'
    arguments: '-armOutputString ''$(rg-ArmOut)'''


- task: AzureResourceManagerTemplateDeployment@3
  inputs:
    deploymentScope: 'Resource Group'
    azureResourceManagerConnection: 'radul (MCT)(d8058b04-7da0-4499-b527-029c6d0158f7)'
    subscriptionId: 'd8058b04-7da0-4499-b527-029c6d0158f7'
    action: 'Create Or Update Resource Group'
    resourceGroupName: '$(Output_rgname)'
    location: 'West Europe'
    templateLocation: 'Linked artifact'
    csmFile: 'vnetbox/virtualnetwork.json'
    overrideParameters: '-envGuid ''$(Output_envGuid)'''
    deploymentMode: 'Incremental'






